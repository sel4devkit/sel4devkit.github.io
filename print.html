<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>seL4 Developer Kit</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="A developer kit for the seL4 microkernel on the Avnet MaaXBoard SBC (Single Board Computer).">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction/main.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="introduction/audience.html"><strong aria-hidden="true">1.1.</strong> Audience</a></li><li class="chapter-item expanded "><a href="introduction/overview.html"><strong aria-hidden="true">1.2.</strong> Overview</a></li><li class="chapter-item expanded "><a href="introduction/structure.html"><strong aria-hidden="true">1.3.</strong> Structure</a></li></ol></li><li class="chapter-item expanded "><a href="resources/main.html"><strong aria-hidden="true">2.</strong> Resources</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="resources/sel4_microkernel.html"><strong aria-hidden="true">2.1.</strong> seL4 Microkernel</a></li><li class="chapter-item expanded "><a href="resources/avent_maaxboard.html"><strong aria-hidden="true">2.2.</strong> Avent MaaXBoard</a></li><li class="chapter-item expanded "><a href="resources/repositories.html"><strong aria-hidden="true">2.3.</strong> Repositories</a></li><li class="chapter-item expanded "><a href="resources/glossary.html"><strong aria-hidden="true">2.4.</strong> Glossary</a></li></ol></li><li class="chapter-item expanded "><a href="development_platform/main.html"><strong aria-hidden="true">3.</strong> Development Platform</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="development_platform/hardware_requirements.html"><strong aria-hidden="true">3.1.</strong> Hardware Requirements</a></li><li class="chapter-item expanded "><a href="development_platform/software_requirements.html"><strong aria-hidden="true">3.2.</strong> Software Requirements</a></li></ol></li><li class="chapter-item expanded "><a href="install_and_configure/main.html"><strong aria-hidden="true">4.</strong> Install and Configure</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="install_and_configure/host_setup.html"><strong aria-hidden="true">4.1.</strong> Host Setup</a></li><li class="chapter-item expanded "><a href="install_and_configure/build_environment_setup.html"><strong aria-hidden="true">4.2.</strong> Build Environment Setup</a></li><li class="chapter-item expanded "><a href="install_and_configure/target_setup.html"><strong aria-hidden="true">4.3.</strong> Target Setup</a></li><li class="chapter-item expanded "><a href="install_and_configure/bootloader_setup.html"><strong aria-hidden="true">4.4.</strong> Bootloader Setup</a></li></ol></li><li class="chapter-item expanded "><a href="first_boot/main.html"><strong aria-hidden="true">5.</strong> First Boot</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="first_boot/bootloader.html"><strong aria-hidden="true">5.1.</strong> Bootloader</a></li><li class="chapter-item expanded "><a href="first_boot/sel4test.html"><strong aria-hidden="true">5.2.</strong> seL4Test</a></li><li class="chapter-item expanded "><a href="first_boot/camkes_adder.html"><strong aria-hidden="true">5.3.</strong> CAmkES Adder</a></li><li class="chapter-item expanded "><a href="first_boot/microkit_hello_world.html"><strong aria-hidden="true">5.4.</strong> Microkit Hello World</a></li></ol></li><li class="chapter-item expanded "><a href="activities/main.html"><strong aria-hidden="true">6.</strong> Activities</a></li><li class="chapter-item expanded "><a href="activity/microkit_memory_probe/main.html"><strong aria-hidden="true">7.</strong> Activity: Microkit Memory Probe</a></li><li class="chapter-item expanded "><a href="activity/device_drivers/main.html"><strong aria-hidden="true">8.</strong> Activity: Device Drivers</a></li><li class="chapter-item expanded "><a href="activity/spi_bus_bmp280_pressure_sensor/main.html"><strong aria-hidden="true">9.</strong> Activity: SPI Bus BMP280 Pressure Sensor</a></li><li class="chapter-item expanded "><a href="activity/camkes_case_study_application/main.html"><strong aria-hidden="true">10.</strong> Activity: CAmkES Case Study Application</a></li><li class="chapter-item expanded "><a href="activity/microkit_case_study_application/main.html"><strong aria-hidden="true">11.</strong> Activity: Microkit Case Study Application</a></li><li class="chapter-item expanded "><a href="activity/microkit_usb_driver/main.html"><strong aria-hidden="true">12.</strong> Activity: Microkit USB Driver</a></li><li class="chapter-item expanded "><a href="activity/microkit_hdmi_driver/main.html"><strong aria-hidden="true">13.</strong> Activity: Microkit HDMI Driver</a></li><li class="chapter-item expanded "><a href="activity/microkit_vmm_single_linux_guest/main.html"><strong aria-hidden="true">14.</strong> Activity: Microkit VMM Single Linux Guest</a></li><li class="chapter-item expanded "><a href="activity/microkit_vmm_dual_linux_guest_tty_multiplex/main.html"><strong aria-hidden="true">15.</strong> Activity: Microkit VMM Dual Linux Guest TTY Multiplex</a></li><li class="chapter-item expanded "><a href="activity/microkit_vmm_dual_linux_guest_usb_routing/main.html"><strong aria-hidden="true">16.</strong> Activity: Microkit VMM Dual Linux Guest USB Routing</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded affix "><a href="licensing.html">Licensing</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">seL4 Developer Kit</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/sel4devkit/sel4devkit-manual" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>The <a href="https://sel4.systems">seL4® Microkernel</a> is a technology of
increasing interest. It delivers specific capabilities and assurances, which
make it particularly suitable for applications that demand a trusted execution
environment and strong separation of concerns.</p>
<p>The seL4 Microkernel is engineered to deliver both high-assurance and
high-performance (<a href="https://sel4.systems/About/seL4-whitepaper.pdf">The seL4 Microkernel: An
Introduction</a>). High-assurance
is achieved through comprehensive formal verification. High-performance is
achieved through deliberate design and profiling, potentially accepting
greater complexity in the formal verification where this achieves higher
performance.</p>
<p>The development of the seL4 Microkernel is overseen by the <a href="https://sel4.systems/Foundation/">seL4
Foundation</a>, operating as project under The
<a href="https://www.linuxfoundation.org/">Linux Foundation</a>. The entirety of the seL4
Microkernel, and its associated components, are made available as Open Source,
on Git Hub (<a href="https://github.com/seL4">seL4 Microkernel and associated
components</a>).</p>
<p>In common with all Microkernels, the seL4 Microkernel provides a minimum set
of essential features as needed to frame a viable OS (Operating System). There
is an expectation that further components will be introduced atop this OS, in
developing useful applications (such as drivers, libraries, and services).</p>
<p>As a consequence, developing on top of the seL4 microkernel is currently
complex and time-consuming, and the expertise is limited to a small number of
individuals and organisations. Thus, this seL4 Developer Kit is created to
reduce the barrier to entry for developing on top of seL4 Microkernel. The
overall intention is to encourage and support more organisations in adopting
seL4 in their projects and products.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="audience"><a class="header" href="#audience">Audience</a></h2>
<p>The intended audience is an application developer:</p>
<ul>
<li>Experienced in programming within a Linux, macOS, or Windows environment.</li>
<li>Already familiar with seL4 concepts and benefits.</li>
<li>Looking for practical guidance in getting started with seL4.</li>
</ul>
<h3 id="complementary-approach"><a class="header" href="#complementary-approach">Complementary Approach</a></h3>
<p>This seL4 Developer Kit does not intend to cover or replace any of the
extensive material as maintained by the (<a href="https://sel4.systems">seL4
Foundation</a>) and associated organisations.</p>
<p>Instead, the purpose is to complement this existing material with practical
guidance about getting started with seL4. Throughout the seL4 Developer Kit,
reference is made to externally maintained material where appropriate.</p>
<h3 id="focus-on-sel4-details"><a class="header" href="#focus-on-sel4-details">Focus on seL4 Details</a></h3>
<p>Whilst the seL4 Developer Kit aims to cover all the important configuration
steps, it does assume a reasonable level of developer knowledge. In general,
priority and prominence is given to seL4 specific details, while more routine
aspects are explained at a higher level or through external reference (such as
installing software or interacting with configuration management).</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>The seL4 Developer Kit intends to support developers in gaining familiarity
with seL4 Microkernel, and ultimately to encourage more use of seL4 within
projects and products. It does this by:</p>
<ul>
<li>
<p>Selecting a readily available low-cost SBC (Single Board Computer) as the
target platform ((The <a href="introduction/%22../avent_maaxboard/main.html">Avnet MaaXBoard</a>).</p>
</li>
<li>
<p>Identifying the minimum needed to create a viable development platform, and
detailing specific hardware and software requirements to achieve this.</p>
</li>
<li>
<p>Supplying preconfigured build environments, plus associated examples, with
all the content required to generate seL4 executable programs.</p>
</li>
<li>
<p>Demonstrating how an seL4 executable program can be loaded and executed on
the chosen target platform.</p>
</li>
<li>
<p>Documenting the specific steps needed, along with more general guidance.</p>
</li>
</ul>
<p>Once the fundamentals of building and executing an seL4 program are
established, the seL4 Developer Kit seeks to explain and encourage further
development through the presentation of a diverse series of technical
(<a href="introduction/%22../activities/activities.html">Activities</a>).</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="structure"><a class="header" href="#structure">Structure</a></h2>
<p>The seL4 Developer Kit is structured into the following sections to provide a
step-by-step guide:</p>
<ul>
<li>
<p><strong>Introduction</strong>: Introduce the potential benefits that the seL4 Microkernel
offers, acknowledge its steep learning curve, and position the seL4
Developer Kit as a means to help facilitate and encourage wider adoption.</p>
</li>
<li>
<p><strong>Resources</strong>: Provides an overview of the fundamental aspects of both the
seL4 Microkernel and the Avent MaaXBoard (our chosen SBC (Single Board
Computer)), highlighting relevant supporting material from other sources. The
technical scope of the seL4 Developer Kit is summerised though a list of its
associated repositories. Finally, a consolidated glossary of key terms is
presented for easy reference.</p>
</li>
<li>
<p><strong>Development Platform</strong>: Identify and explain the minimum hardware and
software requirements needed to assemble a viable development platform for
using the seL4 Developer Kit. It is expected that, to meet these requirements,
some equipment will need to be purchased (for example, an Avent MaaXBoard).</p>
</li>
<li>
<p><strong>Install and Configure</strong>: Provides guidance, and explores options, in
installing and configuring the development platform. Once complete, the
development platform will be ready for building sel4 programs, loading such
programs onto the target, and executing these programs on the target, with
terminal (text) input and output available.</p>
</li>
<li>
<p><strong>First Boot</strong>: Utilising a previously prepared development platform, walk
through the steps in powering up the target (Avnet MaaXBoard), interacting
with the bootloader, and building and executing a small number of example
programs. On completion of this step, the development platform is prepared and
proven to operate.</p>
</li>
<li>
<p><strong>Activities</strong>: With the development platform established, a series of
distinct technical activities are undertaken. Each Activity describes both
its approach, and the eventual outcome, seeking to illustrate how sel4
development may be practically progressed.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resources"><a class="header" href="#resources">Resources</a></h1>
<p>Presents for immediate reference a summary of the various resources associated
with seL4 Developer Kit.</p>
<h1 id="supporting-material"><a class="header" href="#supporting-material">Supporting Material</a></h1>
<p>The seL4 Developer Kit makes use of a large collection of existing material.
Here, we summarise and reference this material, explaining its relevance to
the seL4 Developer Kit.</p>
<p>Distinct areas considered are listed below:</p>
<ul>
<li><a href="resources/%22../resources/sel4_microkernel.html">seL4 Microkernel</a></li>
<li><a href="resources/%22../resources/avent_maaxboard.html">Avent MaaXBoard</a></li>
</ul>
<h1 id="repositories"><a class="header" href="#repositories">Repositories</a></h1>
<p>A summarised list of all the repositories that form part of the seL4 Developer
Kit is presented to support their navigation:</p>
<ul>
<li><a href="resources/reference/repositories.html">Repositories</a></li>
</ul>
<h1 id="glossary"><a class="header" href="#glossary">Glossary</a></h1>
<p>A consolidated glossary of key terms is presented for easy reference:</p>
<ul>
<li><a href="resources/reference/glossary.html">Glossary</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="resources-1"><a class="header" href="#resources-1">Resources</a></h1>
<p>Presents for immediate reference a summary of the various resources associated
with seL4 Developer Kit.</p>
<h1 id="supporting-material-1"><a class="header" href="#supporting-material-1">Supporting Material</a></h1>
<p>The seL4 Developer Kit makes use of a large collection of existing material.
Here, we summarise and reference this material, explaining its relevance to
the seL4 Developer Kit.</p>
<p>Distinct areas considered are listed below:</p>
<ul>
<li><a href="resources/%22../resources/sel4_microkernel.html">seL4 Microkernel</a></li>
<li><a href="resources/%22../resources/avent_maaxboard.html">Avent MaaXBoard</a></li>
</ul>
<h1 id="repositories-1"><a class="header" href="#repositories-1">Repositories</a></h1>
<p>A summarised list of all the repositories that form part of the seL4 Developer
Kit is presented to support their navigation:</p>
<ul>
<li><a href="resources/reference/repositories.html">Repositories</a></li>
</ul>
<h1 id="glossary-1"><a class="header" href="#glossary-1">Glossary</a></h1>
<p>A consolidated glossary of key terms is presented for easy reference:</p>
<ul>
<li><a href="resources/reference/glossary.html">Glossary</a></li>
</ul>
<p>shaped in terms of a large collection of existing
material in framinig a</p>
<p>deliver a</p>
<p>brings together a large collection of existing
material, for the s</p>
<p>built can be framed as</p>
<p>brings together a large collection of</p>
<p>is built atop many</p>
<p>intends to support developers in gaining familiarity</p>
<p>There
An overview
We present a</p>
<ul>
<li>
<p><strong>seL4 Microkernel</strong>: A consolidated overview of the fundamental aspects of
the seL4 Microkernel, highlighting relevant material available from other
sources.</p>
</li>
<li>
<p><strong>Avent MaaXBoard</strong>: Explain the selection of our chosen SBC (Single Board
Computer), providing a consolidated overview of its core features,
highlighting relevant material available from other sources.</p>
</li>
</ul>
<p>The <a href="https://sel4.systems">seL4® Microkernel</a> is a technology of
increasing interest. It delivers specific capabilities and assurances, which
make it particularly suitable for applications that demand a trusted execution
environment and strong separation of concerns.</p>
<p>The seL4 Microkernel is engineered to deliver both high-assurance and
high-performance (<a href="https://sel4.systems/About/seL4-whitepaper.pdf">The seL4 Microkernel: An
Introduction</a>). High-assurance
is achieved through comprehensive formal verification. High-performance is
achieved through deliberate design and profiling, potentially accepting
greater complexity in the formal verification where this achieves higher
performance.</p>
<p>The development of the seL4 Microkernel is overseen by the <a href="https://sel4.systems/Foundation/">seL4
Foundation</a>, operating as project under The
<a href="https://www.linuxfoundation.org/">Linux Foundation</a>. The entirety of the seL4
Microkernel, and its associated components, are made available as Open Source,
on Git Hub (<a href="https://github.com/seL4">seL4 Microkernel and associated
components</a>).</p>
<p>In common with all Microkernels, the seL4 Microkernel provides a minimum set
of essential features as needed to frame a viable OS (Operating System). There
is an expectation that further components will be introduced atop this OS, in
developing useful applications (such as drivers, libraries, and services).</p>
<p>As a consequence, developing on top of the seL4 microkernel is currently
complex and time-consuming, and the expertise is limited to a small number of
individuals and organisations. Thus, this seL4 Developer Kit is created to
reduce the barrier to entry for developing on top of seL4 Microkernel. The
overall intention is to encourage and support more organisations in adopting
seL4 in their projects and products.</p>
<p>highlighting relevant material available from other
sources.</p>
<ul>
<li><strong>Avent MaaXBoard</strong>: Explain the selection of our chosen SBC (Single Board
Computer), providing a consolidated overview of its core features,
highlighting relevant material available from other sources.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo"><a class="header" href="#todo">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-1"><a class="header" href="#todo-1">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-2"><a class="header" href="#todo-2">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development-platform"><a class="header" href="#development-platform">Development Platform</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hardware-requirements"><a class="header" href="#hardware-requirements">Hardware Requirements</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="software-requirements"><a class="header" href="#software-requirements">Software Requirements</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="first-boot"><a class="header" href="#first-boot">First Boot</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="host-setup"><a class="header" href="#host-setup">Host Setup</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="build-environment-setup"><a class="header" href="#build-environment-setup">Build Environment Setup</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bootloader-setup"><a class="header" href="#bootloader-setup">Bootloader Setup</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bootloader-setup-1"><a class="header" href="#bootloader-setup-1">Bootloader Setup</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="activities"><a class="header" href="#activities">Activities</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-3"><a class="header" href="#todo-3">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="device-drivers"><a class="header" href="#device-drivers">Device Drivers</a></h1>
<ul>
<li><a href="activity/device_drivers/device_driver_intro.html">Device Driver Introduction</a></li>
<li><a href="activity/device_drivers/uboot_driver_library.html">U-Boot Driver Library Overview</a></li>
<li><a href="activity/device_drivers/uboot_driver_usage.html">Using the U-Boot Driver Library</a></li>
<li><a href="activity/device_drivers/uboot_library_add_platform.html">Library Extension - New Platform</a></li>
<li><a href="activity/device_drivers/uboot_library_add_driver.html">Library Extension - New Driver</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-4"><a class="header" href="#todo-4">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-5"><a class="header" href="#todo-5">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-6"><a class="header" href="#todo-6">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-7"><a class="header" href="#todo-7">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hdmi-driver"><a class="header" href="#hdmi-driver">HDMI Driver</a></h1>
<p>For this task the aim was to create an hdmi display driver using our current devkit setup. For inspiration looked at U-Boot’s implementation of an imx8m display driver. We chose to look at U-Boot’s solution compared to the linux contribution because it is BSD licensed, less fully featured and simpler to understand.</p>
<p>The repository for this project is located at: https://github.com/sel4-cap/sel4-hdmi</p>
<h2 id="displaying-a-static-image"><a class="header" href="#displaying-a-static-image">Displaying a static image</a></h2>
<p>The first step involved understanding the basics of display drivers so that we could define our goals for the project. The first goal was to understand U-Boot’s display driver and to set up our memory regions for the frame buffer and the physical devices required by the driver. After building and running the U-Boot example, we looked through the source code and found relevant sections in IMX8M technical specification to get a better understanding of how to write the display driver.</p>
<p>Through reading the technical specification we learnt that the two main components of the Maaxboard needed for the driver are the DCSS (Display Controller Subsystem) and the HDMI TX Controller. With this information we were able to understand the purpose of the memory register read and write operations and which register bits needed to be set for specific functionality. We decided to use one protection domain for the simplicity of having one area to handle all operations.</p>
<p>After gaining a deeper understanding of Maaxboard and U-Boots implementation, we set values for the essential memory registers including where to set the address of the frame buffer to. For the framebuffer, we defined a region of memory that was large enough for our currently selected screen resolution and bit depth.</p>
<p>In order to read and write from specific memory registers, they must be explicitly defined in the system file for the PD that they are being accessed from. This is an essential concept to grasp when working with microkit. The majority of the code was taken from U-Boot, so the main focus of this part of the task was to set up the parts of the code that directly interfaced with the hardware. For other projects this could include registering and handling interrupts.</p>
<p>Our initial display configuration had a screen resolution of 1280x720 and a colour depth of 32 bit RGB. This meant that each pixel was composed of 32 bits with 8 bits reserved for each colour and an additional alpha channel for colour transparency. With this information, we were able to create a simple image displaying 4 colours red, green, blue and white as 4 equally spaced bars across the screen. We then experimented with different screen resolutions which involved re-defining the size of the framebuffer so that it could accommodate larger screen resolutions.</p>
<h2 id="displaying-a-moving-image"><a class="header" href="#displaying-a-moving-image">Displaying a moving image</a></h2>
<p>The next goal was to display a moving image, which first involved learning about the theory of double buffering and understanding the capabilities of the Maaxboard’s DCSS. Double buffering makes use of two buffers. The first stores the current frame, whilst the second buffer is used to store the next frame. Whilst the current frame is being displayed the second buffer is being written to. During the window of time where the image on screen is not actively being redrawn, the pointers to each buffer are swapped.</p>
<p>U-Boot’s implementation did not provide any capability to drive video, so we needed to investigate and understand the technical specification in greater detail. We found a component of the DCSS called the Context Loader which can be configured to change various parts of the display state at specific timing intervals. This would act as the trigger to switch the pointers to each frame buffer.</p>
<p>For our implementation we decided to use two PD’s. One PD contains the display driver, consisting of the DCSS and the HDMI TX Controller. The other PD contains the api and examples which demonstrate different use cases of the driver. The system is designed such that the two PD’s communicate with each other through notifications and make use of a single shared DMA memory region. This memory region is split into different parts which are accessed by a pointer with a specific offset for different parts of the memory e.g frame buffer 1, frame buffer 2. This approach was implemented for simplicity so that the memory is easily accessible, however it would be better to define individual DMA regions for specific tasks, so that certain parts of the memory are only exposed to the PD that should have access to it.</p>
<p>The initial time to redraw the buffer was slow because we were writing 8 bits of the 32 bit pixel at a time. To combat this we optimised the code logic reducing loops and where possible, we wrote 16, 32 or 64 bits at a time to minimise the amount of separate cpu instructions. This example is limited by the technology that we have available to us. For fully fledged display drivers, there will be extra bits of hardware that will be able to handle the different stages of processing video, drastically increasing performance.</p>
<p>For moving images a visible redraw is seen when switching between frames which is most noticeable when the entire screen has changed. Multiple attempts have been made to combat this issue, which have been listed in the repo for this activity.</p>
<p>The API contains the following examples:</p>
<ul>
<li>static_image - Displays 4 colour bars on the screen.</li>
<li>resolution_change - Displays a square of the same size in pixels one after another at three different resolutions.</li>
<li>rotating_bars - Displays 4 colour bars rotating across the screen.</li>
<li>moving_square - A small square that moves around the screen, changing direction each time it hits the side of the screen.</li>
</ul>
<p>TO DO:</p>
<ul>
<li>Talk about the firmware being used and the config options that need to be disabled.</li>
<li>Add some more specific code examples (What other things in this process could help someone to do something similar)</li>
<li>Split into different sections</li>
<li></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="single-linux-guest"><a class="header" href="#single-linux-guest">Single Linux guest</a></h1>
<p>For this task, the goal was to load up a virtual machine (VM) on a host with serial TTY passthrough. Our starting point for this activity was to rework an example from the Trustworthy Systems libvmm repository so that it runs on the Maaxboard. This repo contains a virtual machine monitor for the seL4 microkernel with various examples built for the Odroid board and the open source emulator Qemu. Libvmm provides a virtual machine monitor (VMM) which in our example is used to start and manage the guest VM.</p>
<p>To create the linux kernel image we used buildroot. Buildroot is an open source project that automates the process of building a complete and bootable Linux environment for an embedded system. We chose buildroot because the process to create a basic linux kernel image is straightforward. <strong>(More on build root)</strong></p>
<p>The VM doesn’t necessarily know it's being virtualised, so it will try to perform read and write operations on certain devices and memory regions that it shouldn’t have access to. When setting up the project there were a number of virtual memory faults, which were caused by the guest VM trying to access devices that it was not exposed to in the system file. Generally, there are three approaches to fix this.</p>
<p>One approach is to disable the device node in the device tree so that it does not try to access the device. This approach may not be feasible because the memory region may be required by a specific process in your system or dependent on another device in order to function. Another approach is to disable the device driver in the guest configuration (This can be configured with buildroot). The last approach is to utilise device “pass-through” which is where the address of the device is mapped into the guest VM allowing access directly to the device. Ideally, in a virtualised environment the guest VM shouldn’t have access to physical devices. However, for simplicity and with the absence of a serial driver it was necessary to pass through the serial device and the devices that depend on it.</p>
<p>Two memory regions that are required to be passed through for the use of libvmm and our example are the RAM and the Generic Interrupt Controller Virtual CPU (GIC-VCPU). In order for the linux guest to be able to run, it needs to have an area of contiguous space directly allocated for its own RAM. In its current implementation libvmm expects the physical memory address and the virtual memory area for the RAM to be at the same address. At a minimum there needed to be enough memory to load the kernel image and other associated binaries. The size and position of this memory need to reflect the memory node in the device tree. The GIC-VCPU is used to signal virtual interrupts. Libvmm provides a driver to handle this device which is necessary for running any guest operating system with libvmm.. <strong>(more on memory? - dual tty activity will detail memory sizing issues)</strong></p>
<ul>
<li>Another issue we faced when setting up the VM was SMC…</li>
<li>Talk about how to run the project and how it works generally. Why is this useful, what do we have here?</li>
<li>Did anything trip us up on the way?</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vmm-with-dual-linux-guests-and-tty-multiplex"><a class="header" href="#vmm-with-dual-linux-guests-and-tty-multiplex">VMM with dual linux guests and TTY Multiplex</a></h1>
<p>For this activity the goal was to load two linux Virtual Machines (VM) on one host. This was achieved by building upon our previous single guest example and taking inspiration from an existing libvmm contribution that makes use of VirtIO console. For this example five Protection Domains (PD) are used. Two PD’s are used for each virtual machine, one for the UART serial driver and the remaining two for the TX and RX communication to handle the serial data. <strong>(Explain RX and TX briefly)</strong></p>
<p>VirtIO is an interface used by virtual machines to use its hosts’ devices through the means of virtual devices. The main role of these devices is to get data to and from the hosts physical hardware. VirtIO consists of three main parts: front-end drivers, back-end devices, and VirtQueues.</p>
<p>Typically, the front end drivers exist in the hosts kernel. These can be turned on in the config file when creating a linux kernel with buildroot. They are responsible for accepting I/O requests from user processes, transfering I/O requests to its corresponding back-end VirtIO device and retrieving completed requests from the back-end device. The back-end devices typically exist in the VMM. Libvmm provides implementations for console, network, block and sound devices. They are responsible for accepting I/O requests from the corresponding front-end driver,
handling the requests by offloading the I/O operations to the host’s physical hardware,
and making the processed and requested data available to the VirtIO driver.</p>
<p>VirtQueues are shared memory regions that are used by a VirtIO front-end driver and back-end device pair. A VRing is a data structure contained within the VirtQueue that facilitates data transfer between the VirtIO device and driver. Libvmm follows version 1.2 of the VirtIO specification and uses the seL4 Device Driver Framework (SDDF) to implement the VirtQueues for specific devices.</p>
<p>In our example, we make use of the VirtIO Console device to handle serial I/O data. To use VirtIO Console a node was created in the device tree and a multiple settings turned on in the linux kernel config file. In the “chosen” node of the device tree, the stdout path and the boot args also needed to be set up specifically for the console device. In our initial implementation we passed through 8 additional devices. We then managed to remove the need for 7 of them by disabling them in the device tree. The remaining “gpc” device was needed by virtio-console, but at this stage it is unknown why.</p>
<ul>
<li>Memory considerations for two linuxes. (Where this is set up, tweaking was needed)</li>
<li>Talk about the timer, priorities of the two VM’s</li>
<li>What was the missing thing that bill found so that we could get set up?</li>
<li>add in more failures and attempts at things</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="todo-8"><a class="header" href="#todo-8">TODO</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="licensing"><a class="header" href="#licensing">Licensing</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
